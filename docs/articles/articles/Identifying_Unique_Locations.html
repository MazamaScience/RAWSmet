<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Identifying Unique Locations • RAWSmet</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet">
<script src="../../pkgdown.js"></script><meta property="og:title" content="Identifying Unique Locations">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../../index.html">RAWSmet</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../../articles/RAWSmet.html">Get started</a>
</li>
<li>
  <a href="../../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/articles/Identifying_Unique_Locations.html">Identifying Unique Locations</a>
    </li>
    <li>
      <a href="../../articles/articles/Oregon_2020_LaborDay.html">September 2020 Oregon Wildfires</a>
    </li>
    <li>
      <a href="../../articles/articles/Working_with_openair.html">Working With openair</a>
    </li>
  </ul>
</li>
<li>
  <a href="../../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/MazamaScience/RAWSmet">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Identifying Unique Locations</h1>
                        <h4 class="author">Mazama Science</h4>
            
            <h4 class="date">August 18, 2020</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/MazamaScience/RAWSmet/blob/master/vignettes/articles/Identifying_Unique_Locations.Rmd"><code>vignettes/articles/Identifying_Unique_Locations.Rmd</code></a></small>
      <div class="hidden name"><code>Identifying_Unique_Locations.Rmd</code></div>

    </div>

    
    
<div id="problem" class="section level2">
<h2 class="hasAnchor">
<a href="#problem" class="anchor"></a>Problem</h2>
<p>When working with environmental monitoring time series, one of the first things you have to do is create unique identifiers for each individual time series. In an ideal world, each environmental time series would have both a <code>locationID</code> and a <code>sensorID</code> that uniquely identify the spatial location and specific instrument making measurements. A unique <code>timeseriesID</code> could be produced as <code>locationID_sensorID</code>. Location metadata associated with each time series would contain basic information needed for downstream analysis including at least:</p>
<p><code>timeseriesID, locationID, sensorID, longitude, latitude, ...</code></p>
<ul>
<li>Multiple sensors placed at a location could be be grouped by <code>locationID</code>.</li>
<li>An extended time series for a mobile sensor would group by <code>sensorID</code>.</li>
<li>Maps would be created using <code>longitude, latitude</code>.</li>
<li>Time series would be accessed from a secondary <code>data</code> table with <code>timeseriesID</code>.</li>
</ul>
<p>Unfortunately, we are rarely supplied with a truly unique and truly spatial <code>locationID</code>. Instead we often use <code>sensorID</code> or an associated non-spatial identifier as a standin for <code>locationID</code>.</p>
<p>Complications we have seen include:</p>
<ul>
<li>GPS-reported longitude and latitude can have <em>jitter</em> in the fourth or fifth decimal place making it challenging to use them to create a unique <code>locationID</code>.</li>
<li>Sensors are sometimes <em>repositioned</em> in what the scientist considers the “same location”.</li>
<li>Data for a single sensor goes through different processing pipelines using different identifiers and is later brought together as two separate timeseries.</li>
<li>The radius of what constitutes a “single location” depends on the instrumentation and scientific question being asked.</li>
<li>Deriving location-based metadata from spatial datasets is computationally intensive unless saved and identified with a unique <code>locationID</code>.</li>
<li>Automated searches for spatial metadata occasionally produce incorrect results because of the non-infinite resolution of spatial datasets and must be corrected by hand.</li>
</ul>
</div>
<div id="mazamalocationutils" class="section level2">
<h2 class="hasAnchor">
<a href="#mazamalocationutils" class="anchor"></a>MazamaLocationUtils</h2>
<p>The <strong>MazamaLocationUtils</strong> package provides a solution to these problems by storing spatial metadata in simple tables in a standard directory. These tables will be referred to as <em>collections</em>. Location lookups can be performed with geodesic distance calculations where a location is assigned to a pre-existing <em>known location</em> if it is within <code>radius</code> meters. These will be extremely fast.</p>
<p>If no previously <em>known location</em> is found, the relatively slow (seconds) creation of a new <em>known location</em> metadata record can be performed and then added to the growing collection.</p>
<p>For collections of stationary environmental monitors that only number in the thousands, this entire <em>collection</em> (<em>i.e.</em> “database”) can be stored as either a <code>.rda</code> or <code>.csv</code> file and will be under a megabyte in size making it fast to load. This small size also makes it possible to store multiple <em>known location</em> files, each created with different locations and different radii to address the needs of different scientific studies.</p>
<p>While initially exploring spatial metadata for RAWS sites, the <code><a href="https://rdrr.io/pkg/MazamaLocationUtils/man/table_findOverlappingLocations.html">MazamaLocationUtils::table_findOverlappingLocations()</a></code> function will identify locations that seem too close to be considered “unique”. It will ultimately be up to the user of the data to decide what to do with “overlapping” time series.</p>
<p>The following examples demonstrate how to explore RAWS location metadata using functionality from <strong>MazamaLocationUtils</strong>.</p>
</div>
<div id="working-with-data-from-cefa-dri-eduraws" class="section level2">
<h2 class="hasAnchor">
<a href="#working-with-data-from-cefa-dri-eduraws" class="anchor"></a>Working with data from cefa.dri.edu/raws</h2>
<p>Well formamtted archival RAWS data is avaialable from <a href="https://cefa.dri.edu/raws" class="uri">https://cefa.dri.edu/raws</a>.</p>
<div id="spatial-metadata" class="section level3">
<h3 class="hasAnchor">
<a href="#spatial-metadata" class="anchor"></a>Spatial metadata</h3>
<p>Metadata containing station IDs and location information can be accessed using the <code>fw13_createMetadtat()</code> function</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(RAWSmet)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"></a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(MazamaSpatialUtils)</a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="kw"><a href="https://rdrr.io/pkg/MazamaSpatialUtils/man/setSpatialDataDir.html">setSpatialDataDir</a></span>(<span class="st">"~/Data/Spatial"</span>)</a>
<a class="sourceLine" id="cb1-5" data-line-number="5"></a>
<a class="sourceLine" id="cb1-6" data-line-number="6">meta &lt;-<span class="st"> </span><span class="kw"><a href="../../reference/fw13_createMeta.html">fw13_createMeta</a></span>(<span class="dt">verbose =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb1-7" data-line-number="7"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(meta)</a></code></pre></div>
<pre><code>## # A tibble: 6 x 11
##   nwsID wrccID nessID siteName longitude latitude timezone elevation countryCode
##   &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;        &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;        &lt;dbl&gt; &lt;chr&gt;      
## 1 0215… &lt;NA&gt;   &lt;NA&gt;   AHAKAHV…    -114.      34.1 America…       360 US         
## 2 5007… &lt;NA&gt;   &lt;NA&gt;   ALCAN H…    -141.      62.8 America…      1800 US         
## 3 0204… &lt;NA&gt;   &lt;NA&gt;   ALPINE      -109.      33.8 America…      8188 US         
## 4 5007… &lt;NA&gt;   &lt;NA&gt;   ANGEL C…    -146.      65.0 America…      1100 US         
## 5 0321… &lt;NA&gt;   &lt;NA&gt;   ARMSTEA…     -92.8     35.6 America…      1600 US         
## 6 0107… &lt;NA&gt;   &lt;NA&gt;   BANKHD       -87.3     34.3 America…       989 US         
## # … with 2 more variables: stateCode &lt;chr&gt;, agency &lt;chr&gt;</code></pre>
<p>This dataframe of 1791 records contains unique identifiers and locations.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(meta)</a></code></pre></div>
<pre><code>## [1] 1791</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">meta <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(nwsID, longitude, latitude) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/n_distinct.html">n_distinct</a></span>()</a></code></pre></div>
<pre><code>## [1] 1791</code></pre>
<p>We can use the <strong>MazamaLocationUtils</strong> to discover those locations that are too close to be considered unique “known locations”.</p>
<p>If we assume that stations spaced &lt;200 meters apart are measuring the same parcel of air, we can say that unique “known locations” for RAWS stations should have a radius of 100m. We can use the following code see if this is the case:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">tooCloseTbl &lt;-</a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="st">  </span>MazamaLocationUtils<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/MazamaLocationUtils/man/table_findOverlappingLocations.html">table_findOverlappingLocations</a></span>(meta, <span class="dt">radius =</span> <span class="dv">100</span>)</a>
<a class="sourceLine" id="cb7-3" data-line-number="3"></a>
<a class="sourceLine" id="cb7-4" data-line-number="4"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(tooCloseTbl)</a></code></pre></div>
<pre><code>## # A tibble: 7 x 3
##    row1  row2 distance
##   &lt;int&gt; &lt;int&gt;    &lt;dbl&gt;
## 1   738   739     30.9
## 2   750   751     38.6
## 3   770   771     55.7
## 4  1597  1598     56.7
## 5   120   179     65.9
## 6   325   326     76.1
## 7   493   494    187.</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="co"># Extract siteName from meta dataframe</span></a>
<a class="sourceLine" id="cb9-2" data-line-number="2"><span class="cf">for</span> ( i <span class="cf">in</span> <span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq_len</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(tooCloseTbl)) ) {</a>
<a class="sourceLine" id="cb9-3" data-line-number="3">  rows &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(tooCloseTbl[i, <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>])</a>
<a class="sourceLine" id="cb9-4" data-line-number="4">  <span class="kw"><a href="https://rdrr.io/r/base/cat.html">cat</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span>(<span class="st">"</span><span class="ch">\n</span><span class="st">%5.1f meters apart:</span><span class="ch">\n</span><span class="st">"</span>, tooCloseTbl<span class="op">$</span>distance[i]))</a>
<a class="sourceLine" id="cb9-5" data-line-number="5">  <span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(meta[rows, <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">'longitude'</span>, <span class="st">'latitude'</span>, <span class="st">'siteName'</span>)])</a>
<a class="sourceLine" id="cb9-6" data-line-number="6">}</a></code></pre></div>
<pre><code>## 
##  30.9 meters apart:
## # A tibble: 2 x 3
##   longitude latitude siteName   
##       &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;      
## 1     -155.     19.3 KEALAKOMO 2
## 2     -155.     19.3 KEALAKOMO 2
## 
##  38.6 meters apart:
## # A tibble: 2 x 3
##   longitude latitude siteName 
##       &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;    
## 1     -157.     21.1 MOLOKAI1 
## 2     -157.     21.1 MOLOKAI 1
## 
##  55.7 meters apart:
## # A tibble: 2 x 3
##   longitude latitude siteName      
##       &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;         
## 1     -158.     21.5 WAIANAE VALLEY
## 2     -158.     21.5 WAIANAE VALLEY
## 
##  56.7 meters apart:
## # A tibble: 2 x 3
##   longitude latitude siteName  
##       &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;     
## 1     -108.     42.6 CAMP CREEK
## 2     -108.     42.6 CAMP CREEK
## 
##  65.9 meters apart:
## # A tibble: 2 x 3
##   longitude latitude siteName   
##       &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;      
## 1     -90.7     34.8 MARRIANNA  
## 2     -90.7     34.8 ST. FRANCIS
## 
##  76.1 meters apart:
## # A tibble: 2 x 3
##   longitude latitude siteName
##       &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;   
## 1     -120.     40.0 COYOTE  
## 2     -120.     40.0 COYOTE  
## 
## 186.7 meters apart:
## # A tibble: 2 x 3
##   longitude latitude siteName         
##       &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;            
## 1     -109.     37.5 MOCKINGBIRD      
## 2     -109.     37.5 SAN JUAN PORTABLE</code></pre>
</div>
<div id="timeseries-data-1-overlapping-timeseries" class="section level3">
<h3 class="hasAnchor">
<a href="#timeseries-data-1-overlapping-timeseries" class="anchor"></a>Timeseries data 1 – Overlapping timeseries</h3>
<p>Given that many of these <code>nwsID</code> pairs share the same <code>siteName</code>, we can create a timeseries plot do see which of two possible situations we all into:</p>
<ol style="list-style-type: decimal">
<li>two RAWS instruments with overlapping measurements that should be considered separate time series</li>
<li>two RAWS instruments with non-overlapping measurements that can be considered a single time series</li>
</ol>
<p>Obtain timeseries objects (with separate <code>meta</code> and <code>data</code> dataframes) using the <code>nwsID</code> obtained from each record:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="co"># CAMP CREEK stations are separated by 56.7 m, row #4 from tooCloseTbl</span></a>
<a class="sourceLine" id="cb11-2" data-line-number="2"><span class="co">#    ...</span></a>
<a class="sourceLine" id="cb11-3" data-line-number="3"><span class="co">#    4  1597  1598     56.7</span></a>
<a class="sourceLine" id="cb11-4" data-line-number="4"></a>
<a class="sourceLine" id="cb11-5" data-line-number="5">nwsID_<span class="dv">1</span> &lt;-<span class="st"> </span>meta<span class="op">$</span>nwsID[<span class="dv">1597</span>]</a>
<a class="sourceLine" id="cb11-6" data-line-number="6">nwsID_<span class="dv">2</span> &lt;-<span class="st"> </span>meta<span class="op">$</span>nwsID[<span class="dv">1598</span>]</a>
<a class="sourceLine" id="cb11-7" data-line-number="7"></a>
<a class="sourceLine" id="cb11-8" data-line-number="8"><span class="co"># Get timeseries data</span></a>
<a class="sourceLine" id="cb11-9" data-line-number="9">CampCreek_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw"><a href="../../reference/fw13_createTimeseriesObject.html">fw13_createTimeseriesObject</a></span>(nwsID_<span class="dv">1</span>, meta)</a>
<a class="sourceLine" id="cb11-10" data-line-number="10">CampCreek_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw"><a href="../../reference/fw13_createTimeseriesObject.html">fw13_createTimeseriesObject</a></span>(nwsID_<span class="dv">2</span>, meta)</a>
<a class="sourceLine" id="cb11-11" data-line-number="11"></a>
<a class="sourceLine" id="cb11-12" data-line-number="12"><span class="co"># Each timeseries object consists of 'meta' and 'data'.</span></a>
<a class="sourceLine" id="cb11-13" data-line-number="13"><span class="co"># We are only interested in the 'data' part:</span></a>
<a class="sourceLine" id="cb11-14" data-line-number="14"></a>
<a class="sourceLine" id="cb11-15" data-line-number="15"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(CampCreek_<span class="dv">1</span><span class="op">$</span>data)</a></code></pre></div>
<pre><code>## # A tibble: 6 x 12
##   datetime            temperature humidity windSpeed windDirection maxGustSpeed
##   &lt;dttm&gt;                    &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;         &lt;dbl&gt;        &lt;dbl&gt;
## 1 1998-06-25 03:00:00        22.2     58.5      6.26           216         13.4
## 2 1998-06-25 04:00:00        22.8     58        7.60           231         18.3
## 3 1998-06-25 05:00:00        23.3     57.5      8.05           234         17.9
## 4 1998-06-25 06:00:00        23.3     57.5      8.49           236         19.2
## 5 1998-06-25 07:00:00        22.8     57.5      8.49           235         17.0
## 6 1998-06-25 08:00:00        23.9     57.5      9.39           251         16.5
## # … with 6 more variables: maxGustDirection &lt;dbl&gt;, precipitation &lt;dbl&gt;,
## #   solarRadiation &lt;dbl&gt;, fuelMoisture &lt;dbl&gt;, fuelTemperature &lt;chr&gt;,
## #   monitorType &lt;chr&gt;</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="co"># ----- Plot them separately -----</span></a>
<a class="sourceLine" id="cb13-2" data-line-number="2"></a>
<a class="sourceLine" id="cb13-3" data-line-number="3"><span class="co"># Hint:  use pch = '.' to speed up graphical rendering</span></a>
<a class="sourceLine" id="cb13-4" data-line-number="4"></a>
<a class="sourceLine" id="cb13-5" data-line-number="5"><span class="kw"><a href="https://rdrr.io/r/graphics/layout.html">layout</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="dv">2</span>)))</a>
<a class="sourceLine" id="cb13-6" data-line-number="6"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(CampCreek_<span class="dv">1</span><span class="op">$</span>data[,<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">'datetime'</span>, <span class="st">'temperature'</span>)], </a>
<a class="sourceLine" id="cb13-7" data-line-number="7">     <span class="dt">col =</span> <span class="st">'black'</span>, <span class="dt">pch =</span> <span class="st">'.'</span>, <span class="dt">main =</span> <span class="st">"Camp Creek 1"</span>)</a>
<a class="sourceLine" id="cb13-8" data-line-number="8"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(CampCreek_<span class="dv">2</span><span class="op">$</span>data[,<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">'datetime'</span>, <span class="st">'temperature'</span>)], </a>
<a class="sourceLine" id="cb13-9" data-line-number="9">     <span class="dt">col =</span> <span class="st">'orange'</span>, <span class="dt">pch =</span> <span class="st">'.'</span>, <span class="dt">main =</span> <span class="st">"Camp Creek 2"</span>)</a></code></pre></div>
<p><img src="Identifying_Unique_Locations_files/figure-html/timeseries_identical-1.png" width="700"></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/graphics/layout.html">layout</a></span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb14-2" data-line-number="2"></a>
<a class="sourceLine" id="cb14-3" data-line-number="3"><span class="co"># ----- Plot them together -----</span></a>
<a class="sourceLine" id="cb14-4" data-line-number="4"></a>
<a class="sourceLine" id="cb14-5" data-line-number="5"><span class="co"># Set up x- and y-limits to cover both timeseries</span></a>
<a class="sourceLine" id="cb14-6" data-line-number="6">xlim &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/range.html">range</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(</a>
<a class="sourceLine" id="cb14-7" data-line-number="7">  <span class="kw"><a href="https://rdrr.io/r/base/range.html">range</a></span>(CampCreek_<span class="dv">1</span><span class="op">$</span>data<span class="op">$</span>datetime, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb14-8" data-line-number="8">  <span class="kw"><a href="https://rdrr.io/r/base/range.html">range</a></span>(CampCreek_<span class="dv">2</span><span class="op">$</span>data<span class="op">$</span>datetime, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb14-9" data-line-number="9">))</a>
<a class="sourceLine" id="cb14-10" data-line-number="10"></a>
<a class="sourceLine" id="cb14-11" data-line-number="11">ylim &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/range.html">range</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(</a>
<a class="sourceLine" id="cb14-12" data-line-number="12">  <span class="kw"><a href="https://rdrr.io/r/base/range.html">range</a></span>(CampCreek_<span class="dv">1</span><span class="op">$</span>data[,<span class="st">'temperature'</span>], <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb14-13" data-line-number="13">  <span class="kw"><a href="https://rdrr.io/r/base/range.html">range</a></span>(CampCreek_<span class="dv">2</span><span class="op">$</span>data[,<span class="st">'temperature'</span>], <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb14-14" data-line-number="14">))</a>
<a class="sourceLine" id="cb14-15" data-line-number="15"></a>
<a class="sourceLine" id="cb14-16" data-line-number="16"><span class="co"># Now plot the temperature timeseries to look for overlaps </span></a>
<a class="sourceLine" id="cb14-17" data-line-number="17"><span class="co"># (use pch = 0 to speed up graphical rendering)</span></a>
<a class="sourceLine" id="cb14-18" data-line-number="18"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(CampCreek_<span class="dv">1</span><span class="op">$</span>data[,<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">'datetime'</span>, <span class="st">'temperature'</span>)], </a>
<a class="sourceLine" id="cb14-19" data-line-number="19">     <span class="dt">xlim =</span> xlim, <span class="dt">ylim =</span> ylim, <span class="dt">col =</span> <span class="st">'black'</span>, <span class="dt">pch =</span> <span class="st">'.'</span>,</a>
<a class="sourceLine" id="cb14-20" data-line-number="20">     <span class="dt">main =</span> <span class="st">"Camp Creek"</span>)</a>
<a class="sourceLine" id="cb14-21" data-line-number="21"><span class="kw"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(CampCreek_<span class="dv">2</span><span class="op">$</span>data[,<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">'datetime'</span>, <span class="st">'temperature'</span>)], </a>
<a class="sourceLine" id="cb14-22" data-line-number="22">       <span class="dt">col =</span> <span class="st">'orange'</span>, <span class="dt">pch =</span> <span class="st">'.'</span>)</a></code></pre></div>
<p><img src="Identifying_Unique_Locations_files/figure-html/timeseries_identical-2.png" width="700"></p>
</div>
<div id="timeseries-data-2-non-overlapping-timeseries" class="section level3">
<h3 class="hasAnchor">
<a href="#timeseries-data-2-non-overlapping-timeseries" class="anchor"></a>Timeseries data 2 – Non-overlapping timeseries</h3>
<p>This next example shows non-overlapping timeseries</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1"><span class="co"># MARIANNA/ST. FRANCSIS stations are separated by 56.7 m, row #5 from tooCloseTbl</span></a>
<a class="sourceLine" id="cb15-2" data-line-number="2"><span class="co">#    ...</span></a>
<a class="sourceLine" id="cb15-3" data-line-number="3"><span class="co">#    5   120   179     65.9</span></a>
<a class="sourceLine" id="cb15-4" data-line-number="4"></a>
<a class="sourceLine" id="cb15-5" data-line-number="5">nwsID_<span class="dv">1</span> &lt;-<span class="st"> </span>meta<span class="op">$</span>nwsID[<span class="dv">120</span>]</a>
<a class="sourceLine" id="cb15-6" data-line-number="6">nwsID_<span class="dv">2</span> &lt;-<span class="st"> </span>meta<span class="op">$</span>nwsID[<span class="dv">179</span>]</a>
<a class="sourceLine" id="cb15-7" data-line-number="7"></a>
<a class="sourceLine" id="cb15-8" data-line-number="8"><span class="co"># Get timeseries data</span></a>
<a class="sourceLine" id="cb15-9" data-line-number="9">Marianna &lt;-<span class="st"> </span><span class="kw"><a href="../../reference/fw13_createTimeseriesObject.html">fw13_createTimeseriesObject</a></span>(nwsID_<span class="dv">1</span>, meta)</a>
<a class="sourceLine" id="cb15-10" data-line-number="10">St_Francis &lt;-<span class="st"> </span><span class="kw"><a href="../../reference/fw13_createTimeseriesObject.html">fw13_createTimeseriesObject</a></span>(nwsID_<span class="dv">2</span>, meta)</a>
<a class="sourceLine" id="cb15-11" data-line-number="11"></a>
<a class="sourceLine" id="cb15-12" data-line-number="12"><span class="co"># Each timeseries object consists of 'meta' and 'data'.</span></a>
<a class="sourceLine" id="cb15-13" data-line-number="13"><span class="co"># We are only interested in the 'data' part:</span></a>
<a class="sourceLine" id="cb15-14" data-line-number="14"></a>
<a class="sourceLine" id="cb15-15" data-line-number="15"><span class="co"># ----- Plot them separately -----</span></a>
<a class="sourceLine" id="cb15-16" data-line-number="16"></a>
<a class="sourceLine" id="cb15-17" data-line-number="17"><span class="kw"><a href="https://rdrr.io/r/graphics/layout.html">layout</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="dv">2</span>)))</a>
<a class="sourceLine" id="cb15-18" data-line-number="18"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(Marianna<span class="op">$</span>data[,<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">'datetime'</span>, <span class="st">'temperature'</span>)], </a>
<a class="sourceLine" id="cb15-19" data-line-number="19">     <span class="dt">col =</span> <span class="st">'black'</span>, <span class="dt">pch =</span> <span class="st">'.'</span>, <span class="dt">main =</span> <span class="st">"Marianna"</span>)</a>
<a class="sourceLine" id="cb15-20" data-line-number="20"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(St_Francis<span class="op">$</span>data[,<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">'datetime'</span>, <span class="st">'temperature'</span>)], </a>
<a class="sourceLine" id="cb15-21" data-line-number="21">     <span class="dt">col =</span> <span class="st">'orange'</span>, <span class="dt">pch =</span> <span class="st">'.'</span>, <span class="dt">main =</span> <span class="st">"St. Francis"</span>)</a></code></pre></div>
<p><img src="Identifying_Unique_Locations_files/figure-html/timeseries_non_identical-1.png" width="700"></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/graphics/layout.html">layout</a></span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb16-2" data-line-number="2"></a>
<a class="sourceLine" id="cb16-3" data-line-number="3"><span class="co"># ----- Plot them together -----</span></a>
<a class="sourceLine" id="cb16-4" data-line-number="4"></a>
<a class="sourceLine" id="cb16-5" data-line-number="5"><span class="co"># Set up x- and y-limits to cover both timeseries</span></a>
<a class="sourceLine" id="cb16-6" data-line-number="6">xlim &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/range.html">range</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(</a>
<a class="sourceLine" id="cb16-7" data-line-number="7">  <span class="kw"><a href="https://rdrr.io/r/base/range.html">range</a></span>(Marianna<span class="op">$</span>data<span class="op">$</span>datetime, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb16-8" data-line-number="8">  <span class="kw"><a href="https://rdrr.io/r/base/range.html">range</a></span>(St_Francis<span class="op">$</span>data<span class="op">$</span>datetime, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb16-9" data-line-number="9">))</a>
<a class="sourceLine" id="cb16-10" data-line-number="10"></a>
<a class="sourceLine" id="cb16-11" data-line-number="11">ylim &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/range.html">range</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(</a>
<a class="sourceLine" id="cb16-12" data-line-number="12">  <span class="kw"><a href="https://rdrr.io/r/base/range.html">range</a></span>(Marianna<span class="op">$</span>data[,<span class="st">'temperature'</span>], <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb16-13" data-line-number="13">  <span class="kw"><a href="https://rdrr.io/r/base/range.html">range</a></span>(St_Francis<span class="op">$</span>data[,<span class="st">'temperature'</span>], <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb16-14" data-line-number="14">))</a>
<a class="sourceLine" id="cb16-15" data-line-number="15"></a>
<a class="sourceLine" id="cb16-16" data-line-number="16"><span class="co"># Now plot the temperature timeseries to look for overlaps </span></a>
<a class="sourceLine" id="cb16-17" data-line-number="17"><span class="co"># (use pch = 0 to speed up graphical rendering)</span></a>
<a class="sourceLine" id="cb16-18" data-line-number="18"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(Marianna<span class="op">$</span>data[,<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">'datetime'</span>, <span class="st">'temperature'</span>)], </a>
<a class="sourceLine" id="cb16-19" data-line-number="19">     <span class="dt">xlim =</span> xlim, <span class="dt">ylim =</span> ylim, <span class="dt">col =</span> <span class="st">'black'</span>, <span class="dt">pch =</span> <span class="st">'.'</span>)</a>
<a class="sourceLine" id="cb16-20" data-line-number="20"><span class="kw"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(St_Francis<span class="op">$</span>data[,<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">'datetime'</span>, <span class="st">'temperature'</span>)], </a>
<a class="sourceLine" id="cb16-21" data-line-number="21">       <span class="dt">col =</span> <span class="st">'orange'</span>, <span class="dt">pch =</span> <span class="st">'.'</span>, <span class="dt">main =</span> <span class="st">"Marianna/St. Francis"</span>)</a></code></pre></div>
<p><img src="Identifying_Unique_Locations_files/figure-html/timeseries_non_identical-2.png" width="700"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#problem">Problem</a></li>
      <li><a href="#mazamalocationutils">MazamaLocationUtils</a></li>
      <li><a href="#working-with-data-from-cefa-dri-eduraws">Working with data from cefa.dri.edu/raws</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Jonathan Callahan, Eli Grosman.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
